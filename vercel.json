{
  "version": 2,
  "routes": [
    // Rewrites
    {
      "src": "/app/core/(.*)",
      "dest": "/app/core/$1.js"
    },
    {
      "src": "/app/(.*)",
      "dest": "/app/$1.js"
    },
    {
      "src": "/modules/(.*)",
      "dest": "/modules/$1.js"
    },
    // Specific for /app/...js files
    {
      "src": "/app/(.*)\\.js",
      "headers": {
        "Content-Type": "application/javascript",
        "Cache-Control": "public, max-age=31536000, immutable",
        "Access-Control-Allow-Origin": "*"
      },
      "continue": false
    },
    // For any .js files (but not in /app/ because they are handled above and continue: false)
    {
      "src": "/(.*)\\.js",
      "headers": {
        "Content-Type": "application/javascript",
        "Access-Control-Allow-Origin": "*"
      },
      "continue": true
    },
    // For .mjs files
    {
      "src": "/(.*)\\.mjs",
      "headers": {
        "Content-Type": "application/javascript"
      },
      "continue": true
    },
    // For JSON in /results/
    {
      "src": "/results/(.*)\\.json",
      "headers": {
        "Content-Type": "application/json"
      },
      "continue": true
    },
    // For any file in /app/ that is not JS (so without .js extension) - set Content-Type
    {
      "src": "/app/(.*)",
      "headers": {
        "Content-Type": "application/javascript"
      },
      "continue": true
    },
    // Finally, catch-all to index.html
    {
      "src": "/(.*)",
      "dest": "/index.html"
    }
  ]
}
